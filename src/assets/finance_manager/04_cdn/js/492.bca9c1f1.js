"use strict";(self.webpackChunkfinance_manager=self.webpackChunkfinance_manager||[]).push([[492],{6492:function(t,e,a){a.r(e),a.d(e,{default:function(){return d}});var n=a(4525),o=a(8905);const r=[{label:"姓名",prop:"name"},{label:"身份证",prop:"identity_card"},{label:"合同状态",prop:"status",width:100},{label:"操作",prop:"operation",width:300,align:"center"}];var i=a(4011),s=a(2325),u={mixins:[n.Z,o.Z],data(){return{columns:r,configPager:{}}},methods:{async donwLoadContract(t){let e=await(0,i.UO)(t),a=await(0,i.w4)(e);(0,s.AB)(a.data,`合同-${t}.docx`),this.$message("下载成功..")},genContract(t){this.doUpdate({data:{id:t}})},getRequestOption(){return{read:{url:"/contract/list",method:"get"},update:{url:"/contract/createFile",method:"post"}}}}},d=(0,a(1001).Z)(u,(function(){var t=this,e=t._self._c;return e("div",[e("GQuery",{on:{queryChange:t.setQuery}}),e("GTable",{attrs:{config:{index:!1,usePager:!0},tableData:t.tableData,columns:t.columns,pager:t.configPager},on:{handleSizeChange:t.doHandleSizeChange,handleCurrentChange:t.doHandleCurrentChange},scopedSlots:t._u([{key:"status",fn:function(a){return[e("el-tag",{attrs:{type:t._f("common")(a.status,"statusColor")}},[t._v(t._s(t._f("common")(a.status,"status")))])]}},{key:"operation",fn:function(a){return[e("GEbutton",{attrs:{disabled:5!==a.status,confirm:`是否确定为【${a.name}】生成合同?`},on:{submit:function(e){return t.genContract(a.id)}}},[t._v("合同生成")]),e("GEbutton",{attrs:{disabled:7!==a.status,type:"success",confirm:`是否确定下载【${a.name}】的合同?`},on:{submit:function(e){return t.donwLoadContract(a.id)}}},[t._v("下载生成")])]}}])})],1)}),[],!1,null,null,null).exports},4011:function(t,e,a){a.d(e,{AK:function(){return i},Qe:function(){return u},UO:function(){return d},Uw:function(){return s},ey:function(){return r},tX:function(){return o},w4:function(){return p}});var n=a(4734);const o=t=>n.Z.post("/loan/create",t),r=t=>n.Z.post("/approve/first/reject",{appId:t,loanId:t}),i=t=>n.Z.post("/approve/first/pass",{appId:t,loanId:t}),s=t=>n.Z.post("/approve/end/reject",{appId:t,loanId:t}),u=t=>n.Z.post("/approve/end/pass",{appId:t,loanId:t}),d=t=>n.Z.get("/contract/download",{params:{id:t}}).then((t=>t.data.data.url)),p=t=>{const e=t.replace("/api","");return n.Z.get(e,{responseType:"blob"})}},4525:function(t,e,a){var n=a(4734);e.Z={data(){return{tableData:[],isLoading:!1,queryOption:null}},beforeDestroy(){this.$options.name},async created(){this.$options.name,await this.checkOption(),this.loadByPage()},methods:{async doSubmit(t){await(0,n.Z)({url:this.queryOption.submit.url,method:this.queryOption.submit.method,...t});this.loadByPage()},selectionChange(t){},async checkOption(){if(this.queryOption=await this.getRequestOption(),!this.queryOption)throw new Error("混入CRUD时，必须重写getRequestOption方法，且返回值不为false等..")},async doDelete(t){await(0,n.Z)({url:this.queryOption.delete.url+t,method:this.queryOption.delete.method});this.loadByPage()},async doUpdate(t,e=""){await(0,n.Z)({url:this.queryOption.update.url+e,method:this.queryOption.update.method,...t});this.loadByPage()},getRequestOption(){return!1},async loadByPage(){this.isLoading=!0;var t=await(0,n.Z)({url:this.queryOption.read.url,method:this.queryOption.read.method,params:this.pager});this.isLoading=!1,this.tableData=Object.freeze(t?.data?.data?.list),this.setTotal(t.data?.data.rows)}}}},8905:function(t,e){e.Z={data(){return{pager:{pageNo:1,pageSize:10,name:""}}},methods:{setQuery(t){this.pager.name=t,this.loadByPage()},doHandleSizeChange(t){this.pager.pageSize=t,this.pager.pageNo=1,this.loadByPage()},doHandleCurrentChange(t){this.pager.pageNo=t,this.loadByPage()},setTotal(t){if(!this.configPager)throw new Error("data必须声明configPager并传递给GTable");this.$set(this.configPager,"total",t)}}}}}]);